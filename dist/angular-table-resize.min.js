angular.module("ngTableResize",[]),angular.module("ngTableResize").directive("resizable",["resizeStorage","$injector",function(t,e){function n(){this.columns=[],this.resizer=r(this),console.log("Resizer",this.resizer);var e=t.loadTableSizes(this.id,this.mode);this.addColumn=function(t){this.columns.push(t)},this.removeColumn=function(t){var e=this.columns.indexOf(t);e>-1&&this.columns.splice(e,1)},this.getStoredWidth=function(t){return e[t.resize]||"auto"},this.saveColumnSizes=function(){e||(e={}),this.columns.forEach(function(t){e[t.resize]=this.resizer.saveAttr(t)}),t.saveTableSizes(table,mode,e)}}function i(t,e){return t.addClass("resize"),o}function o(t,e,n,i){}function r(t){try{var n=t.mode?t.mode:"BasicResizer",i=e.get(n);if(!i)return;return new i(t)}catch(o){return console.error("The resizer "+t.mode+" was not found"),null}}return{restrict:"A",priority:0,compile:i,controller:n,controllerAs:"rzctrl",bindToController:!0,scope:{id:"@",mode:"=?",bind:"=?",container:"@?"}}}]),angular.module("ngTableResize").directive("resize",[function(){function t(){return{pre:e,post:n}}function e(t,e,n,i){t.isFirstDrag=!0,i.addColumn(t),t.$on("$destroy",function(){i.removeColumn(t)}),t.$watch("width",function(e,n){console.log("Setting width to",e),t.setWidth(e)})}function n(t,e,n,o){i(t,o,e),t.width=o.getStoredWidth(t),t.setWidth=function(t){e.css({width:t})}}function i(t,e,n){t.handle=$("<div>",{"class":"handle"}),n.prepend(t.handle);var i=e.resizer.handleMiddleware(t.handle,n);o(t,e,i)}function o(t,e,n){$(t.handle).mousedown(function(i){t.isFirstDrag&&(e.resizer.onFirstDrag(n,t.handle),e.resizer.onTableReady(),t.isFirstDrag=!1);var o={};e.resizer.intervene&&(o=e.resizer.intervene.selector(n),o.column=o,o.orgWidth=$(o).width()),i.preventDefault(),$(t.handle).addClass("active"),$("body").addClass("table-resize");var u=i.clientX,c=$(n).width();$(window).mousemove(r(t,e,n,u,c,o)),$(window).one("mouseup",s(t.handle))})}function r(t,e,n,i,o,r){return function(t){var s=t.clientX,u=s-i,c=e.resizer.calculate(o,u);if(!e.resizer.restrict(c)){if(e.resizer.intervene){var l=e.resizer.intervene.calculator(r.orgWidth,u);if(e.resizer.intervene.restrict(l))return;$(r).width(l)}$(n).width(c)}}}function s(t,e,n){return function(){$(n).removeClass("active"),$(window).unbind("mousemove"),$("body").removeClass("table-resize"),e.resizer.onEndDrag(),e.saveColumnSizes()}}return{restrict:"A",compile:t,require:"^^resizable",scope:{resize:"="}}}]),angular.module("ngTableResize").service("resizeStorage",["$window",function(t){function e(t,e){return t?n+"."+t+"."+e:void console.error("Table has no id",t)}var n="ngColumnResize";this.loadTableSizes=function(n,i){var o=e(n,i),r=t.localStorage.getItem(o);return JSON.parse(r)||{}},this.saveTableSizes=function(n,i,o){var r=e(n,i);if(r){var s=JSON.stringify(o);t.localStorage.setItem(r,s)}}}]),angular.module("ngTableResize").factory("ResizerModel",[function(){function t(t,e,n){this.minWidth=25,this.table=t,this.columns=e,this.container=n,this.handleColumns=this.handles(),this.ctrlColumns=this.ctrlColumns()}return t.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},t.prototype.onTableReady=function(){$(this.table).outerWidth("100%")},t.prototype.handles=function(){return this.columns},t.prototype.ctrlColumns=function(){return this.handleColumns},t.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},t.prototype.handleMiddleware=function(t,e){return e},t.prototype.restrict=function(t){return t<this.minWidth},t.prototype.calculate=function(t,e){return t+e},t.prototype.onEndDrag=function(){},t.prototype.saveAttr=function(t){return $(t).outerWidth()},t}]),angular.module("ngTableResize").factory("BasicResizer",["ResizerModel",function(t){function e(e,r,s){t.call(this,e,r,s),this.ctrlColumns=this.columns,this.intervene={selector:n,calculator:i,restrict:o}}function n(t){return $(t).next()}function i(t,e){return t-e}function o(t){return t<25}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.columns).first().css({width:"auto"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.onFirstDrag=function(){$(this.columns).each(function(t,e){$(e).width($(e).width())})},e.prototype.onEndDrag=function(){var t=$(this.table).outerWidth(),e=0;$(this.columns).each(function(n,i){var o=$(i).outerWidth(),r=o/t*100+"%";e+=o/t*100,$(i).css({width:r})})},e.prototype.saveAttr=function(t){return $(t)[0].style.width},e}]),angular.module("ngTableResize").factory("FixedResizer",["ResizerModel",function(t){function e(e,n,i){t.call(this,e,n,i),this.fixedColumn=$(e).find("th").first(),this.bound=!1}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.columns).first().css({width:"auto"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.ctrlColumns=function(){return $(this.columns).not(":first")},e.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},e.prototype.handleMiddleware=function(t,e){return $(e).next()},e.prototype.restrict=function(t){return this.bound?!(t<this.bound)||($(this.fixedColumn).width("auto"),this.bound=!1,!1):t<this.minWidth||($(this.fixedColumn).width()<=this.minWidth?(this.bound=t,$(this.fixedColumn).width(this.minWidth),!0):void 0)},e.prototype.calculate=function(t,e){return t-e},e}]),angular.module("ngTableResize").factory("OverflowResizer",["ResizerModel",function(t){function e(e,n,i){t.call(this,e,n,i)}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflow:"auto"})},e.prototype.onTableReady=function(){$(this.table).width(1)},e}]);